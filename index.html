<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>BRAIN Score Calculator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body {
      margin: 0;
      background: #0f172a;
      color: #e5e7eb;
      font-family: system-ui, sans-serif;
      padding: 20px;
    }
    h1 { font-size: 26px; margin-bottom: 10px; }
    .section {
      background: #111827;
      border: 1px solid #1f2937;
      border-radius: 12px;
      padding: 16px;
      margin-bottom: 20px;
      box-shadow: 0 10px 30px rgba(0,0,0,.35);
    }
    label {
      display: block;
      margin-top: 10px;
      font-weight: bold;
      font-size: 14px;
      color: #94a3b8;
    }
    select, input[type="number"] {
      width: 100%;
      padding: 10px;
      margin-top: 4px;
      background: #0a0f1a;
      border: 1px solid #1f2937;
      color: #e5e7eb;
      border-radius: 8px;
      font-size: 14px;
    }
    .score, .risk {
      font-size: 18px;
      font-weight: bold;
      margin-top: 10px;
    }
    .low { color: #22c55e; }
    .mod { color: #f59e0b; }
    .high { color: #ef4444; }
    button {
      margin-top: 10px;
      padding: 10px 16px;
      background: #1e40af;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 14px;
    }
    button:hover {
      background: #2563eb;
    }
  </style>
</head>
<body>
  <h1>BRAIN Score Calculator</h1>

  <div class="section">
    <h2>Bleeding Diathesis</h2>
    <label>FIBTEM A5 (mm)</label>
    <input type="number" id="fibtem" />
    <label>EXTEM A5 (mm)</label>
    <input type="number" id="extem" />
    <label>Platelet Count (/µL)</label>
    <input type="number" id="platelets" />
  </div>

  <div class="section">
    <h2>Rotterdam CT Score</h2>
    <label>Basal Cisterns</label>
    <select id="cisterns">
      <option value="0">Normal (0)</option>
      <option value="1">Compressed (1)</option>
      <option value="2">Absent (2)</option>
    </select>
    <label>Midline Shift</label>
    <select id="shift">
      <option value="0">&lt; 5 mm (0)</option>
      <option value="1">≥ 5 mm (1)</option>
    </select>
    <label>Epidural Hematoma</label>
    <select id="edh">
      <option value="0">Present (0)</option>
      <option value="1">Absent (1)</option>
    </select>
    <label>SAH or IVH</label>
    <select id="sah">
      <option value="0">Absent (0)</option>
      <option value="1">Present (1)</option>
    </select>
    <div class="score" id="rotterdamScore">Rotterdam Score: 1</div>
  </div>

  <div class="section">
    <h2>Contusion Index</h2>
    <label>Depth of Contusion</label>
    <select id="depth">
      <option value="0">Absent (0)</option>
      <option value="1">Half cortex (1)</option>
      <option value="2">Full cortex (2)</option>
      <option value="3">White matter extension (3)</option>
    </select>
    <label>Extent of Contusion</label>
    <select id="extent">
      <option value="0">Absent (0)</option>
      <option value="1">Localized (1)</option>
      <option value="2">Moderately extensive (2)</option>
      <option value="3">Extensive (3)</option>
    </select>
    <div class="score" id="contusionIndex">Contusion Index: 0</div>
  </div>

  <div class="section">
    <h2>Admission Clinical State</h2>
    <label>GCS on Admission</label>
    <input type="number" id="gcs" />
    <label>Preop Hemoglobin (g/dL)</label>
    <input type="number" id="hb" />
  </div>

  <div class="section">
    <h2>Total BRAIN Score</h2>
    <div class="score" id="brainScore">Score: 0</div>
    <div class="risk" id="riskLevel">Risk: —</div>
    <button onclick="window.print()">Print</button>
  </div>

  <script>
    function calculateScore() {
      let score = 0;

      const fibtem = parseFloat(document.getElementById("fibtem").value);
      if (fibtem < 9) score += 2;

      const extem = parseFloat(document.getElementById("extem").value);
      if (extem < 35) score += 2;

      const platelets = parseFloat(document.getElementById("platelets").value);
      if (platelets < 100000) score += 1;

      const cisterns = parseInt(document.getElementById("cisterns").value);
      const shift = parseInt(document.getElementById("shift").value);
      const edh = parseInt(document.getElementById("edh").value);
      const sah = parseInt(document.getElementById("sah").value);
      const rotterdam = 1 + cisterns + shift + edh + sah;
      document.getElementById("rotterdamScore").textContent = "Rotterdam Score: " + rotterdam;
      if (rotterdam >= 4) score += 2;

      const depth = parseInt(document.getElementById("depth").value);
      const extent = parseInt(document.getElementById("extent").value);
      const ci = depth * extent;
      document.getElementById("contusionIndex").textContent = "Contusion Index: " + ci;
      if (ci >= 4) score += 1;

      const gcs = parseFloat(document.getElementById("gcs").value);
      if (gcs <= 8) score += 1;

      const hb = parseFloat(document.getElementById("hb").value);
      if (hb < 10) score += 1;

      document.getElementById("brainScore").textContent = "Score: " + score;

      const riskEl = document.getElementById("riskLevel");
      if (score <= 2) {
        riskEl.textContent = "Risk: Low (0–2) – SBE ~0.9%, NPV ~99.1%";
        riskEl.className = "risk low";
      } else if (score <= 6) {
        riskEl.textContent = "Risk: Moderate (3–6) – SBE ~38.5%";
        riskEl.className = "risk mod";
      } else {
        riskEl.textContent = "Risk: High (≥7) – SBE ~88.9%, PPV ~88.9%";
        riskEl.className = "risk high";
      }
    }

    document.querySelectorAll("input, select").forEach(el => {
      el.addEventListener("input", calculateScore);
    });

    calculateScore(); // Initialize on load
  </script>
</body>
</html>
